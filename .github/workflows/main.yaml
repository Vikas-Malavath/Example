name: Flutter Action

on:
  push:
    branches:
      - master

  schedule:
    - cron: "20 13 * * *"

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v1
      - uses: actions/setup-java@v1
        with:
          java-version: '12.x'

      - uses: subosito/flutter-action@v1
        with:
          flutter-version: '3.0.5'

      - run: flutter pub get
      - run: flutter build apk

      - uses: actions/upload-artifact@v2
        with:
          name: release-apk
          path: build/app/outputs/flutter-apk/app-release.apk

      - name: Archive files
        run: |
          sudo apt-get update
          sudo apt-get install zip
          zip -r archive.zip *

      - name: Upload to gdrive
        uses: adityak74/google-drive-upload-git-action@main
        with:
          credentials: ewogICJ0eXBlIjogInNlcnZpY2VfYWNjb3VudCIsCiAgInByb2plY3RfaWQiOiAiZmludXJqYS1zdGFnaW5nIiwKICAicHJpdmF0ZV9rZXlfaWQiOiAiNzAzZTFiOTViN2M2MWE3ZWRiYTcyYWYwZDYxOWQ4ZjU3YmY5ZTg2NiIsCiAgInByaXZhdGVfa2V5IjogIi0tLS0tQkVHSU4gUFJJVkFURSBLRVktLS0tLVxuTUlJRXZnSUJBREFOQmdrcWhraUc5dzBCQVFFRkFBU0NCS2d3Z2dTa0FnRUFBb0lCQVFDeS9LYTR1NFJBNUlwOVxuRTlSelNCMmo0T3UrNkRodzR0V2NVY2c1VGFmNmdMMzdCNkY0ZXF4dnJiOUthRzVzR2dCQjREamV2ZGJJN09LZVxuOW5lUkNqbzNaT0xaS3E2M0t5TnA2VTJBS25xR010Umd4U1hiVlVnNkpEMWJDVVBNZEczcW1tcVBQU1ZUdHhLTFxuWXF0RklROHZtMENOM282THhRM1lrL3ZMQVM3OWZYM2xBNWwwU2kxTFJROXhRaXl4VEFFQkdLaDFkcGpvdGlLelxuc0JCRElzRzJYdjlNRTZOcVM1OWwzTFlqaHdjcEZkMDhNaENuUjhqVmlGSHd5QXV4QWRnTkRDcWZKeHBCTHFTQ1xuOGxwTkVtd25qYjBXSkZvN2tXTThIWVRmT2ovVzZBcW9FMnpFclpROVZyMlhieXRHaUwzTS9BSUFmRk10RFBPY1xuTW1kY2l2UGJBZ01CQUFFQ2dnRUFFVmJ5bStEbXJoYTE1K29jNGRJeHRPZWNUeEZXTG5GN09qcWVDQmNpMTl6VFxuQ3RleForZVNmdnM1RmU5S0MwVDFrMnd5ZGptejdpRXN6ek9YWDhDNjVSVHIrUmZ1ZHlaQnR3ZjREeHVPWlNQVlxuZVU2QUhXQ0VyOFZGQUdYRVlMRkMyTUIrNUVPTE16SUFKT3E1SnVoTi9WR3dEazVxUnRZZlFrVUwxcDNWdkk3YlxuS0hJTk0rVm4rWHJKMUkvK1liK3RSc1ZLMzc5T1Y0bUo3WXJnOHIwWnFlMlEwbzVCVWdUNGNoUXhpVUNKY0F6UVxucFdhNDFjSXRMWThldUM5RFpaOTJFZmk3dXFjSXNJL01Sc0tRdmtEY2tXZ0phcHd0OTdUUGFteDdxY2lvSlI4WlxuNmV6eEl1T2hMS0ROOUJ4TW1TSDNmd0lqeFpCNkoyZ0JuSVdUanQreEFRS0JnUURsc1JMMkljRlZkd2ZsTzVnUVxuaWtLd3ErZHZtQzJyeTlJZTZjYzVKcVdyS09uaklKMWdtUlBKb2prUEtiOGc2dnlJVlRSTjZJNTk5eFgxNGxROFxuc0ZBSXh4S3FKY1h4MlJaLyticnlJWGdHNzQ0RkxvUnF4YVZHRjl4Mm1jWEpGQlRLMEFYOGZBa28zdG5NZHpncFxuWUxIcWM2R200T1pEZWZUT3pZckRkMncwZ1FLQmdRREhmTlVjMmxvOG93NTExcGdNVzE3KzNaM2NzRExKUmdYeVxuVTRpeHlnZVRXSXZ4SkZ5K0c5ZFR6b0FRWmVFYzJySmMvNGcyN29FTCtuVkFZajJpTmRnQm5nRURnTHBCRHlxSlxuSjg1NGQ2by90WWo2c096T0NmTm9OZUR0SGM1aUlCNW9LZ2dTeVJNNFJZZXZLZUc5Vll2MndJekVObkEyQW5Dd1xuVERVMGdtZEtXd0tCZ1FDYXZ1NndabE56ZWVzVzFFeUJzRFI0QklpNjFVTEh3RnpDdU91Z3BGbnU4M1NIc2J4MVxualF3WXh6TTc5UHN3ZVVCRHRXdTBwVjRDblludEMxdUhPNTNnSEFhR0hVYTd4bTd6TDFOMHQzbSs2bnU3SC9qVVxuV200YnlBMmUxY0M3MU15aFN2OE5lSjlQS3J4L2xUNkFHZ1lqbDEyc0tVN1kzUHhDcTVXMlZPblFnUUtCZ0grU1xubGxzZ1RHclF2L09kNjVpamFpbkZJaW82eUErdFp5b2tQNXVySHBNZElrbHhQcG9aQmVoRGUrU0FzcWlZTjA1L1xuMytWNU95K2syUXoyaG9IUXV6VzFqT0pubFRUNzlQREhjeVBaS3hnWkNPT0E5NzkvMzVoNk5FQ1BPaWZJY0ltZVxucjVFTDQrMnRrV3IwZHJkMUdOQVJMVFJodC9yaUxweWY3N3FIMW5SWEFvR0JBTUFxbWlFMVBmZHRUV0lUaUpLR1xub2YxQlFDNGNHY25FRjRCTEZrY2dOK0dOWGJuMXhjUlpxMjFzOVVhV0VIT3EyajBibGJ6R2Q5K2NWRk9heHRaR1xuN0tXTlEwTlRyUm1nLzJaM3hoM2Z1UXlSNVowNEhGSUQvbXEyRFQrM0RPcUJJbnA4cUplOFBWTVZXVTJ4MFJHNFxuZXhUUGlDeHUwVmFnUTZMOXZndGtFR25XXG4tLS0tLUVORCBQUklWQVRFIEtFWS0tLS0tXG4iLAogICJjbGllbnRfZW1haWwiOiAiZGF0YS1pbmdlc3Rpb25AZmludXJqYS1zdGFnaW5nLmlhbS5nc2VydmljZWFjY291bnQuY29tIiwKICAiY2xpZW50X2lkIjogIjEwNTY2MTU1MzA4MTQ0MzQ1NDg0NSIsCiAgImF1dGhfdXJpIjogImh0dHBzOi8vYWNjb3VudHMuZ29vZ2xlLmNvbS9vL29hdXRoMi9hdXRoIiwKICAidG9rZW5fdXJpIjogImh0dHBzOi8vb2F1dGgyLmdvb2dsZWFwaXMuY29tL3Rva2VuIiwKICAiYXV0aF9wcm92aWRlcl94NTA5X2NlcnRfdXJsIjogImh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL29hdXRoMi92MS9jZXJ0cyIsCiAgImNsaWVudF94NTA5X2NlcnRfdXJsIjogImh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL3JvYm90L3YxL21ldGFkYXRhL3g1MDkvZGF0YS1pbmdlc3Rpb24lNDBmaW51cmphLXN0YWdpbmcuaWFtLmdzZXJ2aWNlYWNjb3VudC5jb20iCn0=
          filename: "archive.zip"
          folderId: 1a5SvK_F0ol7F1H-JEPDCI4HhTDCy1-_Y
          name: "documentation.zip" # optional string
          overwrite: "true"